# E10: Open geospatial Data

## Warm Up
### Open Source vs Closed Source
Before diving into **open geospatial data**, let’s pause and think about a bigger question:
> What does it mean for software or data to be *open*?  

Here’s a basic comparison between **open-source** and **closed-source (proprietary)** software:
| Feature                  | Open Source                           | Closed Source                            |
|--------------------------|----------------------------------------|-------------------------------------------|
| **Access to Code**       | Fully visible and editable             | Hidden from the public                    |
| **Usage Rights**         | Usually free to use and modify         | Requires license or payment               |
| **Community Contribution**| Anyone can contribute or fork         | Only internal developers can edit         |
| **Security**             | Transparent (bugs visible & fixable)   | Obscured (depends on vendor response)     |
| **Examples**             | QGIS, Linux, Python, PostgreSQL        | ArcGIS, Windows, Google Earth Pro         |

- **Operating Systems**:  
  In the 90s and 2000s, Linux rose as a symbol of open-source power — challenging Microsoft Windows in server and academic environments. The **GNU/Linux** movement showed that free and open software could be reliable and secure.

- **Modern AI and LLMs**:  
  Today, the open vs closed debate reappears in AI.  
  - Closed: ChatGPT, Gemini, Claude  
  - Open: [Meta’s LLaMA](https://ai.meta.com/llama/), [DeepSeek](https://huggingface.co/deepseek-ai), Mistral  
  Open models allow researchers and developers to experiment freely and drive innovation.  

> Open-source LLMs are especially valuable because training foundational models is largely limited to a few big tech companies. For other companies and universities, it’s just impossible to train such models from scratch. Open-source releases make it possible for researchers and startups to study, fine-tune, and deploy models locally. This openness has enabled a wave of innovation in AI applications, allowing broader participation rather than leaving the field entirely dominated by tech giants.

### Open Source Licenses: What’s Allowed?

Just because something is open-source doesn’t mean you can do anything with it.

Different licenses come with different freedoms and responsibilities. Here are a few major ones:

| License       | Key Characteristics                                                                 | Example Projects        |
|---------------|---------------------------------------------------------------------------------------|-------------------------|
| **GNU GPL**   | Copyleft license: requires derived works to also be open under GPL                   | [Linux](https://www.linux.org/), [QGIS](https://qgis.org/)             |
| **MIT**       | Very permissive: allows reuse in open or closed projects with minimal conditions     | [React](https://react.dev/), [Leaflet.js](https://leafletjs.com/)       |
| **Apache 2.0**| Similar to MIT but with explicit patent protection                                   | [PyTorch](https://pytorch.org/), [VS Code](https://code.visualstudio.com/)     |
| **Creative Commons (CC)** | Often used for open data or content, e.g., maps or images                | [OpenStreetMap (CC BY-SA)](https://www.openstreetmap.org/#map=6/51.33/10.45)|

> The **GNU GPL (General Public License)** ensures that *if you share a modified version*, it must stay open and free for others.

Even in commercial contexts, **open and closed often co-exist**:

- Microsoft now supports Linux and open-source tools (like GitHub).
- ESRI’s ArcGIS is closed-source, but supports open formats (GeoJSON, Shapefile) and integrates with open Python libraries.
- Facebook uses PyTorch (open-source), but builds closed AI products.
#### Why People(Include me) Still Believe in Open Source

Despite business pressures, many developers (myself included!) continue to believe:

> "Open-source helps humanity. It enables learning, collaboration, and shared progress."

- You can learn from the best by reading real code.
- You can adapt tools to your needs — especially important in underfunded communities or research.
- You can **build upon others’ work instead of starting from scratch**.

### OpenGIS
The concept of OpenGIS encompasses two core pillars that establish a comprehensive framework of *Standards, Tools, and Data*:
- Open Standards: Defined primarily by the OGC (Open Geospatial Consortium), these standards ensure interoperability, allowing different systems to communicate seamlessly without vendor lock-in.
- Open Source: This refers to the [FOSS4G (Free and Open Source Software for Geospatial)](https://www.osgeo.org/initiatives/foss4g/) ecosystem, which provides accessible software tools such as QGIS, PostGIS, and GeoServer.

#### The Philosophy
Interoperability: This is the soul of OpenGIS. It ensures that different software systems communicate effectively. Through these standards, web browsers display satellite maps seamlessly, and proprietary software reads open-source data without compatibility issues.

#### The Standards
The [OGC (Open Geospatial Consortium)](https://www.ogc.org/) standards serve as the "universal language" for the industry.
- **Data Service Standards**:
    1. WMS (Web Map Service): Transmits rendered map images (map tiles) for display.
    2. WFS (Web Feature Service): Transmits actual vector data objects (points, lines, polygons) for analysis.
    3. WCS (Web Coverage Service): Transmits coverage data containing raw pixel values, such as elevation or temperature models.
- **Data Format Standards**: Includes GeoPackage (a modern, efficient alternative to Shapefiles), GeoJSON (for web use), and KML.

#### The Stack
The FOSS4G (Free and Open Source Software for Geospatial) ecosystem offers robust tools for every layer of the application.
- Database Layer (Storage): PostgreSQL + PostGIS. This combination acts as the industry de facto standard for spatial data storage.
- Server Layer (Publishing): GeoServer or MapServer. These tools publish stored data to the web using OGC standards.
- Desktop Layer (Analysis): QGIS. This is the primary interface for professionals to analyze data and design maps.
- Client Layer (Visualization): Leaflet, OpenLayers, or MapLibre GL. These libraries enable the rendering of interactive maps in web browsers.
- Processing Layer (Library): GDAL/OGR. This library functions as the cornerstone of almost all GIS software, handling data translation and processing.

#### Open Data
- **OpenStreetMap (OSM)**: Functioning as the "Wikipedia" of the mapping world, this project relies on VGI (Volunteered Geographic Information) to build a global, community-maintained dataset.
- **Government Open Data**: Agencies such as NASA and ESA (Sentinel Hub) provide open access to vast amounts of remote sensing and satellite imagery.


## Task
### Description
Today’s lab will focus on `QGIS` and its related tools. Please keep the following points:
-	**No detailed handout** is provided for this chapter — all instructions will be given here.
-	This exercise is highly flexible and exploratory. You are encouraged to explore freely — from data handling to geoprocessing tasks. **We provide only the foundational workflows and concepts.**
	-	You can choose to work on a topic that interests you, or try to replicate a previous exercise or an online case study.
-	The QGIS interface may vary slightly across different versions or operating systems, but the **core logic and operations remain the same**.
-	While **open data** is a key component of the open GIS ecosystem, this session **does not focus** on it (such as web data services or OpenStreetMap). These topics will be covered in more detail in other lectures.


### 1. Plugins and Basemap Services
In *ArcGIS*, adding high-quality imagery like Google or Bing Maps usually requires:
- Complicated configuration
- Paid services
- Or reliance on slower official basemaps

In contrast, **QGIS** offers a more flexible, open solution using community-developed plugins.
1. Open the **QGIS Plugin Manager**(Plugins -> Manage and Install Plugins...)
2. Search and install the following:
   - `QuickMapServices` – for basemaps  
   - `QuickOSM` – for OpenStreetMap vector data  

> The QGIS plugin ecosystem is powered by global contributors and updates frequently — one of the reasons QGIS is so powerful. This is why we love open-source: it allows contributions from people all around the world, not just a small group of engineers in commercial companies like Esri.

#### Load Multi-Source Basemaps from `QuickMapServices`
**Steps:**
1. Open the *Settings* of this plugin.
2. In *More services* page, select the *Get contributed pack*
3. Then you can load various basemaps in a single click:
  - Google Satellite  
  - OpenStreetMap Standard  
  - CartoDB Dark Matter *(dark background, great for data visualization)*

```{figure} ../images/ex10/osm_getpack.png
---
name: oms_plugin
---
OMS Tool Bar
```
```{figure} ../images/ex10/oms_settings.png
---
name: oms_settings
---
OMS Settings
```
```{figure} ../images/ex10/osm_esri.png
---
name: oms_esri_demo
---
Demo of loading data from OMS
```

#### Load Multi-Source Basemaps from `QuickOSM`
The traditional workflow for acquiring city-scale spatial data is:
1. Search and download a Shapefile from a website  
2. Unzip it  
3. Clean the data  
4. Import into your GIS software  

But with **QGIS + QuickOSM**, you can skip all of that — and request data directly from OpenStreetMap (OSM) in seconds. **Steps:**
1. Open the **QuickOSM** plugin and *quick query* page
2. Set the following fields:
```text
Key: shop       Value: convenience
```
3.	Choose the location:
	-	Canvas Extent (the current visible map area), or
	-	Type a city name (e.g., “Beijing”)
4.	Click Run Query

```{figure} ../images/ex10/osm_query.png
---
name: osm_query_page
---
Example of query in *QuickOSM*
```
> You can change the **Overpass API** in **Parameter** page of OSM if you find query is super slow.
5.  Analyze
  - The data will be downloaded and added directly to your QGIS project as a new vector layer.
	-	Open the attribute table to explore the OSM tag system.
	-	You’ll see a wide range of metadata from contributors worldwide.
  - You can try with a wide range of queries, including different keywords and boundaries. You can also export the query results for further use.
6. Export layers
Simply right-click the layer and select “Export” → “Save Features As…”. Choose your preferred format and adjust the settings as needed. You can also download raster tiles using the *Generate XYZ Tiles(Directory)* tool.
```{figure} ../images/ex10/osm_export_tiles.png
---
name: osm_export_tiles
---
Download Raster Tiles using Raster Tools
```

### 2. Open Processing Toolbox
ArcGIS provides a powerful toolbox, but it is largely *closed and proprietary*.
In contrast, QGIS integrates a wide variety of third-party geospatial engines, including:
- [GRASS GIS](https://grass.osgeo.org/learn/)
- [SAGA GIS](https://saga-gis.sourceforge.io/en/index.html) 
- [GDAL](https://gdal.org/en/stable/)
- [Many Python-based tools](https://plugins.qgis.org/plugins/)

These are all accessible through one unified interface: the **Processing Toolbox**.
1. Open the **Processing Toolbox** panel in QGIS.
2. Instead of using the default QGIS **Buffer** tool, try using:
   - **GRASS → v.buffer**
   - **SAGA → Rasterize**
   - **SAGA → Kernel Density Estimation**

3. Observe the flexibility and different parameter options offered by these tools.

> QGIS is more than just a GIS software — it's a graphical front-end that orchestrates a wide range of open-source geospatial engines. You're using GRASS, SAGA, GDAL, and others all at once, without even leaving the interface.

Some datasets may require additional access or credentials. For example, using the *SRTM-Downloader* plugin may require a valid NASA account. Also, to enable integration between SAGA and QGIS, extra configuration may be needed. You can refer to the [Processing SAGA NextGen Provider](https://plugins.qgis.org/plugins/processing_saga_nextgen/) for more information.
Feel free to experiment with various open-source tools to reproduce earlier tasks — for instance:
  - Shortest path and network analysis from [E7](./ex7.md)
	-	Spatial analysis workflows from [E5](./ex7.md)

```{figure} ../images/ex10/qgis_tools.png
---
name: qgis_open_tools
---
You can find a variety of tools available in the QGIS folder.
```

### 3: Lightweight 3D Visualization
While ArcGIS Pro offers powerful 3D capabilities, sharing your work is often difficult — requiring large project packages or uploading to ArcGIS Online. Meanwhile, starting from scratch to learn web development and front-end technologies can be too time-consuming. We once considered making “publishing a web map” an advanced task — but even as an advanced task, it may be too challenging for most students.

**Steps:**
1. Use the **SRTM Downloader** plugin (if available)  
  or  Load an **online DEM (Digital Elevation Model)** service directly into QGIS.
2. Install and open the **qgis2threejs** plugin.
3. Overlay a **satellite basemap** on top of the DEM.
4. If you have **buildings from OSM** (with height attributes), use extrusion to make them 3D.
5. Click `Export to Web`. Then the plugin will generate a `.html` file.
6. You can open it directly in a browser or send it to others.
```{figure} ../images/ex10/qgis_3dweb.png
---
name: qgis_thressjs_html
---
_qgis2threejs_ Panel
```

### 4: Flow Lines using Geometry Generator
Traditional GIS tools like ArcGIS often require generating new shapefiles for visual effects like “glowing buffers” or “flight paths.”  In contrast, QGIS allows real-time visual styling with **Geometry Generator** withput modifying your original data. What you see on the map doesn’t necessarily have to be stored on disk, it can be dynamically generated through **data-driven styling**.

**Steps:**
1. Add a Dark Base Map
  - Go to `Web → QuickMapServices → CartoDB → Dark Matter`.  
   *(If you don’t see it, go to QuickMapServices settings → More services → Get contributed pack)*   
  - Your canvas should now display a dark gray basemap.
2. Create Temporary Airport Points
  - Click the **New Temporary Scratch Layer** icon.  
   - Name: `Airports`  
   - Geometry type: `Point`  
   - CRS: Use default (EPSG:3857 recommended)  
  - Click the **Toggle Editing** (pencil icon).  
  - Use **Add Point Feature** tool to add 10–20 points across the world (e.g., New York, Tokyo, Sydney...).  

3. Generate Lines with Geometry Generator
  - Press `F7` to open the **Layer Styling Panel**.
  - Select the `Airports` layer.
  - Change **Simple Marker** to `Geometry Generator`.
  - Set Geometry Type to `LineString / MultiLineString`.
  - In the expression box, paste:
    - `$geometry`: current point  
    - `make_point(-0.12, 51.5)`: coordinate of London  
    - `make_line`: draw a line between the two points
```
make_line($geometry, make_point(-0.12, 51.5))
```

> Try moving any point using the **Vertex Tool** — the lines update instantly.
4. Add Glow Effects with Blending

  - Under the **Geometry Generator**, click `Simple Line`.
  - Width: `0.5` or thinner
  - **Layer Rendering**:
   - **Opacity**: `20% - 30%`
   - **Blending Mode**: `Addition` / `Plus` / `Screen`

Now, the center of convergence (London) glows brightly.
```{figure} ../images/ex10/qgid_flowmaps.png
---
name: qgis_flowlines
---
Visulaization of Flow Lines
```

### Advanced Task
- Try building your own Python plugin for QGIS. You can either extend a feature you’ve already worked on, or explore and recreate a plugin that you find interesting. You can check the official QGIS Plugin Development Guide [here](https://docs.qgis.org/3.40/en/docs/pyqgis_developer_cookbook/plugins/index.html) to get started.
- Try more demos like [Monitoring irrigated areas using QGIS & Sentinel-2 satellite images](https://www.youtube.com/watch?v=9ETEGlIYgis&t=665s)


## Materials
- [QGIS Overview](https://qgis.org/project/overview/)
- [Open Geospatial Consortium(OGC)](https://www.ogc.org/)
- [Open Source, from Wiki](https://en.wikipedia.org/wiki/Open_source)
- [The Open Source Geospatial Foundation](https://www.osgeo.org/)
- [Free GIS Data](https://freegisdata.rtwilson.com/)
- [Geofabrik Download Server](https://download.geofabrik.de/)
- [QGIS: Working with Vector Data](https://docs.qgis.org/3.28/en/docs/user_manual/working_with_vector/index.html)
- [Open Geospatial Solutions](https://www.youtube.com/@giswqs)